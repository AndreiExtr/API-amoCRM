(function(){"use strict";var e={697:function(e,t,a){var n=a(751),o=a(641);function l(e,t){const a=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(a)}var c=a(262);const s={},i=(0,c.A)(s,[["render",l]]);var r=i,d=a(220),m=a(33);const u={class:"app"},p={class:"create"},h={class:"create__dropdown"},b={key:0,class:"modal"},k={key:0,class:"deal-form"},y={class:"deal-form__name"},v={class:"deal-form__quantity"},f={class:"deal-form__bt"},C=["disabled"],L={key:1,class:"company-form"},w={class:"form__field"},I={class:"form__buttons"},_=["disabled"],N={key:2,class:"contact-form"},T={class:"form__field"},j={class:"form__field"},g={class:"form__field"},M={class:"form__buttons"},E=["disabled"],D={class:"tabs"},Y=["onClick"],O={class:"tab-content"},J={key:0,class:"deal-table"},z={key:1,class:"company-table"},S={key:2,class:"contact-table"};function X(e,t,a,l,c,s){return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("div",p,[(0,o.Lk)("div",h,[t[15]||(t[15]=(0,o.Lk)("label",{for:"item-select"},"Выберите для создания нового элемента:",-1)),(0,o.bo)((0,o.Lk)("select",{id:"item-select","onUpdate:modelValue":t[0]||(t[0]=e=>c.selectedItem=e),onChange:t[1]||(t[1]=(...t)=>e.onItemSelectChange&&e.onItemSelectChange(...t))},t[14]||(t[14]=[(0,o.Lk)("option",{value:"none"},"Не выбрано",-1),(0,o.Lk)("option",{value:"deal"},"Сделка",-1),(0,o.Lk)("option",{value:"contact"},"Контакт",-1),(0,o.Lk)("option",{value:"company"},"Компания",-1)]),544),[[n.u1,c.selectedItem]])]),c.isModalVisible?((0,o.uX)(),(0,o.CE)("div",b,["deal"===c.selectedItem?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",y,[t[16]||(t[16]=(0,o.Lk)("label",{for:"deal-name"},"Название сделки:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"deal-name","onUpdate:modelValue":t[2]||(t[2]=e=>c.newDeal.name=e),placeholder:"Введите название сделки"},null,512),[[n.Jo,c.newDeal.name]])]),(0,o.Lk)("div",v,[t[17]||(t[17]=(0,o.Lk)("label",{for:"deal-price"},"Цена:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",id:"deal-price","onUpdate:modelValue":t[3]||(t[3]=e=>c.newDeal.price=e),placeholder:"Введите цену сделки"},null,512),[[n.Jo,c.newDeal.price]])]),(0,o.Lk)("div",f,[(0,o.Lk)("button",{class:(0,m.C4)(["create__button",{active:s.isCreateButtonActive}]),disabled:!s.isCreateButtonActive,onClick:t[4]||(t[4]=(...e)=>s.createDeal&&s.createDeal(...e))}," Создать ",10,C),(0,o.Lk)("button",{class:"cancel__button",onClick:t[5]||(t[5]=(...e)=>s.resetForm&&s.resetForm(...e))}," Отмена ")])])):"company"===c.selectedItem?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.Lk)("div",w,[t[18]||(t[18]=(0,o.Lk)("label",{for:"company-name"},"Название компании:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"company-name","onUpdate:modelValue":t[6]||(t[6]=e=>c.newCompany.name=e),placeholder:"Введите название компании"},null,512),[[n.Jo,c.newCompany.name]])]),(0,o.Lk)("div",I,[(0,o.Lk)("button",{class:"create__button",disabled:!c.newCompany.name,onClick:t[7]||(t[7]=(...e)=>s.createCompany&&s.createCompany(...e))}," Создать ",8,_),(0,o.Lk)("button",{class:"cancel__button",onClick:t[8]||(t[8]=(...e)=>s.resetForm&&s.resetForm(...e))},"Отмена")])])):"contact"===c.selectedItem?((0,o.uX)(),(0,o.CE)("div",N,[(0,o.Lk)("div",T,[t[19]||(t[19]=(0,o.Lk)("label",{for:"contact-name"},"Название контакта:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"contact-name","onUpdate:modelValue":t[9]||(t[9]=e=>c.newContact.name=e),placeholder:"Введите название контакта"},null,512),[[n.Jo,c.newContact.name]])]),(0,o.Lk)("div",j,[t[20]||(t[20]=(0,o.Lk)("label",{for:"contact-first-name"},"Имя:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"contact-first-name","onUpdate:modelValue":t[10]||(t[10]=e=>c.newContact.firstName=e),placeholder:"Введите имя"},null,512),[[n.Jo,c.newContact.firstName]])]),(0,o.Lk)("div",g,[t[21]||(t[21]=(0,o.Lk)("label",{for:"contact-last-name"},"Фамилия:",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"contact-last-name","onUpdate:modelValue":t[11]||(t[11]=e=>c.newContact.lastName=e),placeholder:"Введите фамилию"},null,512),[[n.Jo,c.newContact.lastName]])]),(0,o.Lk)("div",M,[(0,o.Lk)("button",{class:"create__button",disabled:!c.newContact.name||!c.newContact.firstName||!c.newContact.lastName,onClick:t[12]||(t[12]=(...t)=>e.createContact&&e.createContact(...t))}," Создать ",8,E),(0,o.Lk)("button",{class:"cancel__button",onClick:t[13]||(t[13]=(...e)=>s.resetForm&&s.resetForm(...e))},"Отмена")])])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",D,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.tabs,(e=>((0,o.uX)(),(0,o.CE)("button",{key:e.value,onClick:t=>c.activeTab=e.value,class:(0,m.C4)({active:c.activeTab===e.value})},(0,m.v_)(e.label),11,Y)))),128))]),(0,o.Lk)("div",O,["deal"===c.activeTab?((0,o.uX)(),(0,o.CE)("table",J,[t[22]||(t[22]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"ID Сделки"),(0,o.Lk)("th",null,"Название"),(0,o.Lk)("th",null,"Цена"),(0,o.Lk)("th",null,"Дата создания")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.deals,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,m.v_)(e.id),1),(0,o.Lk)("td",null,(0,m.v_)(e.name),1),(0,o.Lk)("td",null,(0,m.v_)(e.price),1),(0,o.Lk)("td",null,(0,m.v_)(e.created_at),1)])))),128))])])):"company"===c.activeTab?((0,o.uX)(),(0,o.CE)("table",z,[t[23]||(t[23]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"ID Компании"),(0,o.Lk)("th",null,"Название")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.companies,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,m.v_)(e.id),1),(0,o.Lk)("td",null,(0,m.v_)(e.name),1)])))),128))])])):"contact"===c.activeTab?((0,o.uX)(),(0,o.CE)("table",S,[t[24]||(t[24]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"ID Контакта"),(0,o.Lk)("th",null,"Название"),(0,o.Lk)("th",null,"Имя"),(0,o.Lk)("th",null,"Фамилия")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.contacts,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,m.v_)(e.id),1),(0,o.Lk)("td",null,(0,m.v_)(e.name),1),(0,o.Lk)("td",null,(0,m.v_)(e.first_name),1),(0,o.Lk)("td",null,(0,m.v_)(e.last_name),1)])))),128))])])):(0,o.Q3)("",!0)])])}var F=a(335),Z={name:"HomeView",data(){return{baseDomain:"lirifey500.amocrm.ru",accessToken:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjY5YzI4YTAwYjBjMmUzNTYxNzlmMjA3MWZiZmJiNTFlMTJiM2NkYWQyYjY4YmNkY2ZkYTIyMzUwMzQ1NDk2MTEwYmY2ODc1MzNiMjM5ZTdhIn0.eyJhdWQiOiJlZDEyMDU4NC1lZjRiLTRmZGEtYmEwYS1lZjhiNDA1MzY5NWUiLCJqdGkiOiI2OWMyOGEwMGIwYzJlMzU2MTc5ZjIwNzFmYmZiYjUxZTEyYjNjZGFkMmI2OGJjZGNmZGEyMjM1MDM0NTQ5NjExMGJmNjg3NTMzYjIzOWU3YSIsImlhdCI6MTczNzYxNjI0MywibmJmIjoxNzM3NjE2MjQzLCJleHAiOjE3Mzc3MDI2NDMsInN1YiI6IjEyMDE5Mzc4IiwiZ3JhbnRfdHlwZSI6IiIsImFjY291bnRfaWQiOjMyMTg1MzU4LCJiYXNlX2RvbWFpbiI6ImFtb2NybS5ydSIsInZlcnNpb24iOjIsInNjb3BlcyI6WyJjcm0iXSwiaGFzaF91dWlkIjoiNmI2ZTE2YzUtNTI2ZC00ODIyLTg4ZDItNmNhNjMzNzg2OTE2IiwiYXBpX2RvbWFpbiI6ImFwaS1iLmFtb2NybS5ydSJ9.MGff1mH6uOrZL68L-Ti7Wmm1pvhZSadLdfim_YyhJTry9ShvVr7N33nxuRXMfjXFvfJzksCOngTx_Js6rF24vvOhs_KixGN78WbIpuiJDhyYZ3oNrDJm9jbYOYUqnGSXEgUTCROxOuiCzJBmTHqi6d_rvJKzlAKOqax2C0f3KsOvVef2YBCsIS_NTsPSVvgxn__6n8YWz2NtNZ4wsPvw1Nghv4kimaeNLa1kmlWryNrfGB3H-CCstatDratx0-wc_VehDrScH1nS-PFqjuRGeghJzl6fdpdk1ma6jiC3ftcUyw8N04nwwU7t-1oHElEYjLmoIW4kXgvYv18xTeEbtg",isModalVisible:!0,selectedItem:"none",newDeal:{name:"",price:null},newCompany:{name:""},newContact:{name:"",firstName:"",lastName:""},tabs:[{value:"deal",label:"Сделки"},{value:"company",label:"Компании"},{value:"contact",label:"Контакты"}],activeTab:"deal",deals:[],companies:[],contacts:[]}},computed:{isCreateButtonActive(){return"deal"===this.selectedItem?this.newDeal.name&&this.newDeal.price>0:"none"!==this.selectedItem}},watch:{activeTab(e){this.handleTabChange(e),sessionStorage.setItem("activeTab",e)}},mounted(){const e=sessionStorage.getItem("activeTab");e&&this.tabs.some((t=>t.value===e))?this.activeTab=e:this.activeTab=this.tabs[0].value,this.handleTabChange(this.activeTab)},methods:{async createCompany(){console.log("Отправляемая информация:",this.newCompany);try{const e=await F.A.post("http://localhost:3000/create-company",this.newCompany,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.accessToken}`}});e.data.createdCompany&&(console.log("Добавляем новую компанию:",e.data.createdCompany),this.companies.push({id:e.data.createdCompany.id,name:this.newCompany.name}),console.log("Обновленный список компаний:",this.companies),this.isModalVisible=!1)}catch(e){console.error("Ошибка при добавлении компании:",e)}},async createDeal(){try{const e=await F.A.post("http://localhost:3000/create-deal",this.newDeal,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.accessToken}`}});console.log("Ответ от сервера:",e.data),e.data.createdDeal&&(this.deals.push({id:e.data.createdDeal.id,name:this.newDeal.name,price:this.newDeal.price,created_at:(new Date).toLocaleString()}),this.isModalVisible=!1)}catch(e){console.error("Ошибка при создании сделки:",e),e.response?console.error("Ответ от сервера:",e.response.data):console.error("Ошибка сети или сервера")}},async handleTabChange(e){if("deal"===e){await this.getToken();try{const e=await fetch("http://localhost:3000/get-deals"),t=await e.json();t.deals?this.deals=t.deals:console.error("Ошибка:",t.error||"Не удалось загрузить сделки")}catch(t){console.error("Ошибка при загрузке сделок:",t)}}else"company"===e?await this.fetchCompanies():"contact"===e&&await this.fetchContacts()},async fetchCompanies(){await this.getToken();try{const e=await fetch("http://localhost:3000/get-companies"),t=await e.json();t.companies?this.companies=t.companies:console.error("Ошибка:",t.error||"Не удалось загрузить компании")}catch(e){console.error("Ошибка при загрузке компаний:",e)}},async fetchContacts(){await this.getToken();try{const e=await fetch("http://localhost:3000/get-contacts"),t=await e.json();t.contacts?this.contacts=t.contacts:console.error("Ошибка:",t.error||"Не удалось загрузить контакты")}catch(e){console.error("Ошибка при загрузке контакты:",e)}},async getToken(){try{const e=await fetch("http://localhost:3000/get-token"),t=await e.json();t.access_token&&t.base_domain?console.log("Токен и домен успешно получены"):console.error("Не удалось получить токен и домен")}catch(e){console.error("Ошибка при получении токена:",e)}},resetForm(){this.newDeal={name:"",price:null},this.newCompany={name:""},this.newContact={name:"",firstName:"",lastName:""},this.selectedItem="none"}}};const x=(0,c.A)(Z,[["render",X]]);var U=x;const A=[{path:"/",name:"home",component:U}],V=(0,d.aE)({history:(0,d.LA)("/API-amoCRM/"),routes:A});var W=V,G=a(278),B=(0,G.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,n.Ef)(r).use(B).use(W).mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,l){if(!n){var c=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],l=e[d][2];for(var s=!0,i=0;i<n.length;i++)(!1&l||c>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(s=!1,l<c&&(c=l));if(s){e.splice(d--,1);var r=o();void 0!==r&&(t=r)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,o,l]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,l,c=n[0],s=n[1],i=n[2],r=0;if(c.some((function(t){return 0!==e[t]}))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(i)var d=i(a)}for(t&&t(n);r<c.length;r++)l=c[r],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(d)},n=self["webpackChunkcompany"]=self["webpackChunkcompany"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(697)}));n=a.O(n)})();
//# sourceMappingURL=app.a142925d.js.map